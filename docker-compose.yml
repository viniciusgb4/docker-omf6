version: '2'
services:
  broker:
      build:
          context: ./broker
      image: broker
      container_name: broker
      networks:
            - internet
            - fibre_net
            - cm_net
#                ipv4_address: 10.0.0.200
      volumes:
          - ./broker/omf-images:/root/omf-images
          - ./broker/data/omf_sfa:/root/omf_sfa
      privileged: true
      restart: unless-stopped
#  pubsub:
#      image: rabbitmq:3-management
#      container_name: pubsub
#      hostname: testbed
#      ports:
#          - 5672:5672 # port for the daemon API, can be exposed to public.
#          - 15672:15672 # port for the Management interface
#      env_file: rabbitmq.env


networks:
    internet:
         driver: bridge
    fibre_net:
        external:
            name: fibre_nw
    cm_net:
            external:
                name: cm_nw
#      com.docker.network.enable_ipv6: "true"
#      com.docker.network.bridge.host_binding_ipv4: 10.0.0.1
#    ipam:
#      driver: default
#      config:
#      - subnet: 10.0.0.0/16
#        gateway: 172.16.238.1